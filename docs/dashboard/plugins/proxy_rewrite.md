# 转发重写

### 插件信息

| 名称     | 字段          | 属性     |
| -------- | ------------- | -------- |
| 转发重写 | proxy_rewrite | 参数处理 |

### 功能描述

该插件用于对上游代理信息进行重写，支持对 `scheme`、`uri`、`host` 的重写，同时支持对转发请求的请求头部header的值进行新增或者删除。

注意事项：

* 对uri的重写支持正则替换

### 配置参数说明

| 参数名    | 说明                                                         | 是否必填 | 默认值 | 值可能性         |
| --------- | ------------------------------------------------------------ | -------- | ------ | ---------------- |
| scheme    | 设置转发请求的scheme                                         | 否       | http   | ["http","https"] |
| uri       | 设置转发请求的新uri地址                                      | 否       |        | string           |
| regex_uri | 对原uri进行正则替换并将其设置到转发请求的新uri地址。该字符串数组有两个值，第一个表示匹配请求的uri所需要的正则表达式，第二个表示匹配成功后所需要的uri替换正则表达式。 | 否       |        | array_string     |
| host      | 设置转发请求的新host地址                                     | 否       |        | string           |
| headers   | 能对转发请求的头部值进行新增或删除                           | 否       |        | object           |

**注意事项**：

* uri和regex_uri均用于修改uri，uri和regex_uri不能同时为空，至少一项有值。若同时有值，则uri的值优先。
* 想要删除转发请求头部里的值，只需要将对应的值设置为空字符串即可。

### 全局开启转发重写插件

![](http://data.eolinker.com/course/d14eqRs76212a8b3ea6f4d8d5382942cb5036a947eebb40.gif)

### 配置带有转发重写插件的服务

**配置说明**：将转发请求的`scheme`设置为http，`uri`设置为`/apinto/demo` ,`host`设置为 `127.0.0.1`，同时请求头部中新增`apinto:demo`。

![](http://data.eolinker.com/course/nmLyWQYf770150c255656bfb2f20726e3f1baed4d6b1d7d.gif)

