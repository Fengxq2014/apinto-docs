# 应用管理

调用API的主体都称之为应用，应用管理是对所有应用在不同集群鉴权及生命周期管理。提供新建应用、搜索、查看、上下线以及鉴权等功能。系统内置匿名应用，如有开放性API，无需限制应用鉴权权限等场景。

网关对匿名应用和其他应用处理逻辑： 
* 当没有应用上线（包括匿名应用），此时不需要鉴权，所有请求被放行 

* 当有应用上线，此时匿名应用开启上线，此时可鉴权可不鉴权，若鉴权失败，则走匿名应用逻辑 

* 当有应用上线，此时匿名应用开启上线，且给匿名应用配置了访问策略，仅允许匿名应用访问生效范围内的API，其他API请求都需要应用鉴权

* 当有应用上线，此时匿名应用禁用下线，此时必须要做鉴权
   
应用管理列表如下图所示：

![](http://data.eolinker.com/course/e9Xczqk6fc2ce7113e46300e2427d0ba4282e1efd52222a.png)
## 功能展示
### 新建应用

新建应用如下图所示：

![](http://data.eolinker.com/course/htgYrPGdd2a20d09098bbab590ba18a0cec5ec0ccf03fb5.png)

部分字段说明：

| 字段名称       | 字段描述                                   |
|------------|----------------------------------------|
| 应用ID       | 唯一应用ID，默认系统生成，可根据具体业务修改些应用ID           |
| 自定义属性      | 支持多属性，自定义key-value，主要用于流量筛选、透传上游、统计分析等 |
| Header额外参数 | 支持多属性，自定义key-value，主要用于上游系统鉴权          |
### 搜索应用
搜索结果下图所示：

![](http://data.eolinker.com/course/jzV9HX23bb75080e6e82b35df0d9bbffd0921169dcfe800.png)

搜索框输入要搜索的应用名称，支持模糊搜索，输入完成点击回车键（Enter），自动刷新搜索结果。
### 上线管理
上线管理如下图所示：

![](http://data.eolinker.com/course/dcfHK8T37ce3ab8db37d16c3c69c1882bdcb8c9e3c247c7.png)

* 上线管理的列表显示该应用在所有集群的状态和禁用状态，可对该应用所在每个集群进行上线、下线、禁用以及启用操作。

* 应用要上线到哪个网关集群，必须至少有一种鉴权，鉴权信息是网关判断是哪个应用的唯一凭证。 

* 应用在集群的初始状态为未上线，禁用状态为未禁用，上线操作后变为已上线，该应用才具备调用API资格。 

* 当状态为已上线或待更新时，对禁用状态修改，都会更改控制台应用所在集群状态为待更新，需要更新到网关才会生效。

* 禁用状态中的已禁用表示该应用在集群不生效，网关会对应用进行鉴权，但不会转发请求。
### 应用详情
应用信息如下图所示：

![](http://data.eolinker.com/course/MRmCRPFb20de6a581af216712aa5918b04a3768c43006f6.png)
应用详情-鉴权管理如下图所示：

![](http://data.eolinker.com/course/GDVNkaF2d9c0107553429e70e1aacd3fbd60a63f8a3de46.png)
应用支持配置同种多个或多种多个鉴权，网关只要匹配到任意鉴权就意味着应用鉴权通过。

支持Basic、AkSk、Apikey以及JWT四种鉴权方式，除了系统内置匿名应用外，其他应用都需要配置鉴权才能上线到相应的集群。
#### 配置Basic鉴权
应用详情-鉴权管理-配置Basic鉴权如下图所示：

![](http://data.eolinker.com/course/6xEptFza664d9c3e4dc1d475b5af2319023d83613b8fc40.png)

部分字段说明：

| 字段名称  | 字段描述                                       |
|-------|--------------------------------------------|
| 透传上游  | 鉴权信息是否透传到上游；应用到网关的鉴权数据是否转发给上游              |
| 鉴权类型  | 支持Basic、AkSk、Apikey以及JWT四种鉴权方式             |
| 参数位置  | 支持Header和Query，默认Header，Authorization为参数名称 |
| 用户名   | 用户名                                        |
| 密码    | 密码                                         |
| 标签信息  | 用户标签，当basic校验成功后，该标签会加入请求上下文中              |
| 过期时间  | 可选，不选时间即 不过期                               |

 #### 配置Aksk鉴权
应用详情-鉴权管理-配置AkSk鉴权如下图所示：

![](http://data.eolinker.com/course/LbXH9J23f0a5276e53945e811b18af3d53d8819bd0161f9.png)

部分字段说明：

| 字段名称  | 字段描述                                       |
|-------|--------------------------------------------|
| 透传上游  | 鉴权信息是否透传到上游；应用到网关的鉴权数据是否转发给上游              |
| 鉴权类型  | 支持Basic、AkSk、Apikey以及JWT四种鉴权方式             |
| 参数位置  | 支持Header和Query，默认Header，Authorization为参数名称 |
| AK    | access key                                 |
| SK    | secret key                                 |
| 标签信息  | 支持多个K-V，应用鉴权通过，标签信息会加入到上下文中                |
| 过期时间  | 可选，不选时间即不过期                                |

 #### 配置Apikey鉴权
应用详情-鉴权管理-配置Apikey鉴权如下图所示：

![](http://data.eolinker.com/course/4kPRsVC551a4ee9bb6db5b7f9cd4d53ff081442bbe988a6.png)

部分字段说明：

|字段名称| 字段描述|
|---|---|
|透传上游|鉴权信息是否透传到上游；应用到网关的鉴权数据是否转发给上游|
|鉴权类型|支持Basic、AkSk、Apikey以及JWT四种鉴权方式|
|参数位置|支持Header和Query，默认Header，Authorization为参数名称|
|apikey|apikey值|
|标签信息|用户标签，当apikey匹配成功后，该标签会加入请求上下文中|
|过期时间|可选，不选时间即不过期|
#### 配置Jwt鉴权
应用详情-鉴权管理-配置JWT鉴权如下图所示：

![](http://data.eolinker.com/course/ytqGt7Ud8d4690c596883bd99838647f0cb750127886279.png)
部分字段说明：

| 字段名称           | 字段描述                                             |
|----------------|--------------------------------------------------|
| 透传上游           | 鉴权信息是否透传到上游；应用到网关的鉴权数据是否转发给上游                    |
| 鉴权类型           | 支持Basic、AkSk、Apikey以及JWT四种鉴权方式                   |
| 参数位置           | 支持Header和Query，默认Header，Authorization为参数名称       |
| 算法             | 支持HS系列、RS系列以及ES系列算法                              |
| Iss            | 签发者                                              |
| Secret         | 密钥，仅在签名算法为HS256、HS384、HS512有效                    |
| rsa_public_key | RSA公钥，仅在算法为ES256、ES384、ES512、RS256、RS384、RS512有效 |
| 标签信息           | 用户标签，当鉴权信息校验成功后，该标签会加入请求上下文中                     |
| 过期时间           | 可选，不选时间即不过期                                      |